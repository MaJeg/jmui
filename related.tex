
\section{Background and motivations}
\label{backgd}

\subsection{Definition of turn-taking in conversation}


In most human conversations, participants
alternate turns so as to avoid speaking at the same
time \citep{sacks_simplest_1974}. This phenomenon is often mentionned under
the term turn-taking \citep{sacks_simplest_1974}, and the interval when
the speech is attributed to one participant is called a
turn. 

One of the most noticeable properties of turn-taking in human conversation is that participants often exchange turns
smoothly \citep{heldner_pauses_2010}, the duration of silence between two turns
lasting few hundreds of milliseconds. It should be noticed that this principle
of smooth exchange of speaking turns varies across
cultures, languages and types of conversation \citep{oconnell_turntaking_2008,stivers_universals_2009},
nevertheless this principle can be applied
to French conversations \citep{mondada_multimodal_2007}, which is the type of
conversation towards which our model applies.
This property of smoothness of the conversation still continue to question researchers interested in the study of human conversations. To explain how human participants in conversations are able to coordinate smoothly their speaking turns, several models have been elaborated. In the next section we review these different models.

\subsection{How human participants exchange turns ?}
\label{social_psychology}

The most well known model explaining how participants are able to coordinate their speaking turns is the model elaborated by Sacks et al. \citep{sacks_simplest_1974}. The authors consider that it exists a coordination
mechanism that permits
the smooth transitions observed during conversations.
More precisely, speaking turns are composed of
Turn Constructional Units (TCU) : group of words or several sentences that the listeners perceive and use to precisely identify moments appropriate to initiate a turn transition, moments known as Transition Relevant Places (TRP).

For Sacks et al. \citep{sacks_simplest_1974}, at these TRP, any deviation of this set of rules is considered
as a violation of the turn-taking system, and a
repair mechanism should be applied to resolve this situation.
Such violations of the turn-taking mechanism
encompass listeners that try to take the turn outside a
TRP leading to competitive overlaps \citep{schegloff_overlapping_2000}.
This first approach is based on the assumption that
listeners are able to predict precisely the current speaker's end of turn, based on the multimodal behavior
of the latter \citep{de_ruiter_projecting_2006,french_turn-competitive_1983,ford_interactional_1996,mondada_multimodal_2007}. 

While being the most widely used and cited approach, other competing approaches have challenged the model elaborated by Sacks et al. \citep{sacks_simplest_1974}.
As an alternative to the prediction approach, the signal reaction approach, initiated by Duncan \citep{duncan_signals_1972} does
not follow this assumption of prediction made by Sacks et al., nor assumes
the existence of the rule system at TRP elaborated by Sacks et al. \citep{sacks_simplest_1974}. The authors following this approach consider
that the coordination of speaking turns is mainly
the result of a negotiation process where both speaker
and listeners actively act towards taking the turn. The
coordination of turns among the participants is based
on verbal and nonverbal signals produced at the very
end of turns. Such signals are produced by the current
speaker and the current listeners to inform the participants
of their willingness, respectively, to give or to take
the turn. The current listener is then free to react to the
end of turn signals by taking or not the turn and the
current speaker is free to react to turn claiming
signals by giving up or continuing the turn. Several turn ending, turn claiming and turn keeping signals have been identified since the seminal article of Duncan \citep{duncan_signals_1972}. These signals encompass for example variations in prosody \citep{duncan_signals_1972,gravano_turn-taking_2011,hjalmarsson_additive_2011}, gesture \citep{duncan_signals_1972,mondada_multimodal_2007}, gaze \citep{kendon_functions_1967,novick_coordinating_1996,oertel_gaze_2013} and vocal patterns such as fillers \citep{benus_pragmatic_2011} and inbreath \citep{torreira_breathing_2015}.  

Recent work in psychology have criticized
the assumption of the two preceding approaches, claiming that turn-taking is an affair of ``rights" and ``obligations", particularly related to turn-taking. O'Connell et al.\citep{oconnell_turn-taking_1990} argued that `` the ultimate criterion for success in conversation is not the smooth interchange of speaking
turns [...] but the fulfillment of the purpose entertained
by participants". According to their view, turn-taking
doesn't exist per se as an independant procedure deliberately
taken into account by participants, but the way
participants exchange turns is grounded in the situational
and environmental context of the conversation.
Thus cultural norms, the purpose of the conversation
and the content of the conversation, among other variables,
directly influence the way participants coordinate
their turns, leading to more or less simultaneous speech
or more or less silence between turns. Several authors
have also shown that interruptions, situations where listeners
take the turn while the speaker didn't finish his
utterance, are not always conflictual, some are, in fact,
cooperative, linked for example to a listener collaboratively
completing the utterance of the speaker \citep{clancy_co-constructed_2015}, and
are not always linked to display of dominance or power
\citep{goldberg_interrupting_1990}.

That means that creating an agent able to vary its
own behavior related to turn-taking, such as choosing to
interrupt the user if it has something important to say,
or letting on purpose a certain amount of silence before
taking the turn, would not degrade the interaction, but,
if it is made coherently with the dialog context, on the
opposite, enrich the interaction. This view has been
supported by recent studies made by \citep{ter_maat_how_2010} and \citep{cafaro_effects_2016} measuring
the effects of different turn-taking behaviors (referred as ``strategies") on
the user's impression about the agent.
ter Maat et al.\citep{ter_maat_how_2010} showed that varying the response time of the utterance of an agent following the end of turn of the user gave different impressions about the personality and the attitude of the agent towards the user, an agent starting systematically a few hundred milliseconds before the end of the user's turn being perceived as more dominant and assertive, contrarily an agent taking the turn seconds after the end of the user's turn being less assertive and more submissive.  
Cafaro et al.\citep{cafaro_effects_2016} studied the effect of different types of interrupting
behavior (competitive or collaborative) on the user's
impression about the engagement, interpersonal attitude
and involvement of agents. They found that the type of interruption, more than
the disruptive or cooperative strategy employed by the
agent, influenced the user's impression about the interpersonal
attitudes of the participants.

Previous studies, showed the existence of turn-taking signals, but did not observe the dynamics of such signals.
Some authors specifically studied the dynamics of turn-taking signals and showed  participants continuously adapted their turn-taking signals to the other participant.
 Levitan et al. \citep{levitan_entrainment_2015} observed for example some
alignment effects in the amount of silence before participants
take the turn, and showed that the pitch level of
the next speaker at the beginning of the turn tended to
be similar to the prosody level of the previous speaker
at the end of his turn. 
Alignment effects are also observed in respiratory patterns of participants close to the current speaker's end of turn \citep{mcfarland_respiratory_2001}.
Finally, Wilson and Zimmerman\citep{wilson_structure_1986} in for English and Bailly et al. \citep{bailly_pauses_2012} for French conversations, observed that inter-turns transitions were not randomly distributed but were multiple of a unit of time. According to \citep{wilson_oscillator_2005} this could be explained by an alignment in the cycle of pronunciation of syllables between
the previous speaker and the next speaker.


\subsection{Computational models of turn-taking for embodied conversational agents}
\label{comp_modelling}


The main goal of computational models of turn-taking for user-agent interaction is to satisfy the strict sequencing of speaking turns between users and agents, mostly in
dyadic settings, by accurately detecting when the user has finished to speak while differentiating pauses from end of turn. Accurately recognizing user's ends of turn
will decrease the involuntary overlaps in conversations of the agent linked to bad perceptions of the user's end of turns and will make silence durations between the user's end of turn and the agent's beginning of turn as short as observed
in human conversations \citep{balentine_debouncing_1997,ward_root_2005,raux_optimizing_2012,
jonsdottir_distributed_2013}.

The simplest approaches use fixed temporal threshold to determinate if a silence can be considered as the end of the user's turn. These approaches were proven to be inefficient, decreasing the
smoothness of interaction between user and agent \citep{ward_root_2005}. To
overcome these limits, some authors used a mechanism
of dynamic threshold to make the agent adapt to the
situation and to the user \citep{bohus_decisions_2011,witt_modeling_2014}. In order to improve the recognition accuracy of the different user's actions linked to turn-taking (turn-yielding, taking, grabbing), authors, following the Signal Reaction Approach \citep{duncan_signals_1972}, tried to perceive different signals displayed by the user to inform his current behavior linked to turn-taking.   
This encompass rule-based systems \citep{cassell_embodiment_1999,thorisson_natural_2002}, and probabilistic
models that use either a decision theoretic approach
approach \citep{bohus_decisions_2011,raux_optimizing_2012}, offline machine learning on transcriptions of human conversations \citep{schlangen_reaction_2006,huang_multimodal_2011} or realtime reinforcement learning \citep{jonsdottir_distributed_2013} to accurately detect the user's end of turns while discriminating end of turns from simple pauses made by the user. 

Contrarily, very few models adopted Sacks et al.'s view that end of turns are primarily projected. As such kind of models, \citep{de_vault_incremental_2011} created a model dedicated to the prediction of the meaning of the user's utterance that could serve in real-time to generate interruptions, or to take the turn without virtually no gap and no overlap.

A second issue more related to barge-in management
have been addressed by Reidsma et al. \citep{reidsma_continuous_2011}, Selfridge et al.\citep{selfridge_continuously_2013}, Witt et al.\citep{witt_modeling_2014} and Paek et al. \citep{paek_continuous_2000}. It relates to observations
made in user-system interactions that dialog systems
often falsely detects user's utterances as barge-ins whereas
the latter is only giving some feedback to the system by
producing a vocal backchannel, or is not speaking to the
system. Several studies have thus explored how a spoken
dialogue system could reliably distinguish barge-in
attempts from cooperative feedbacks or speech not intended
to the system. This was either done by analyzing the results of an incremental speech recognizer \citep{selfridge_continuously_2013}, by estimating the probability of a user starting to speak at one moment in the interaction \citep{witt_modeling_2014} or used a classifier to use prosodic, temporal and verbal features to distinguish between user competitive overlaps and listener responses \citep{reidsma_continuous_2011}. Finally, Paek et al. \citep{paek_continuous_2000} used gaze to infer if an utterance from the user is directed to the system or not. 

Several authors designed agents producing turn-taking signals to clarify to the users their intentions related to turn-taking. In multi-party conversations between user and virtual agents or robots, several approaches have shown the effectiveness of controlling the agent's gaze behavior to select the future speaker \citep{mutlu_storytelling_2006,bohus_facilitating_2010,al_moubayed_regulating_2015}. In dyadic settings, \citep{skantze_turn-taking_2014} showed that an agent averting its gaze when pausing (but not releasing its turn) helped the user to identify the behavior of the agent.

The models presented above are essentially dedicated to the detection of the user's behavior related to turn-taking permitting
to reduce moments of silence and overlaps, thus improving the quality of the interaction. They partly rely on the initial assumptions made by researchers on
turn-taking that interrupting or not taking
the turn after the user's end of turn is a violation
of the turn-taking system, and could lead to a ``break
down" in the conversation \citep{cutler_analysis_1986}. Thus in user-agent interactions,
the agent is seen as having ``obligations" towards
taking the turn without leaving a too long silence
moment and not interrupting the user \citep{de_kok_multimodal_2009}.

Contrarily, several authors created computational models of
turn-taking for user-agent or agent-agent interactions
that varied the turn-taking behavior of the agent based
on several variables. Selfridge et al. \citep{selfridge_bidding_2009} created a model for a dyadic
agent-agent setting, where the motivation of the agents
to take the turn was mostly driven by the importance
of the utterance they had to say. To evaluate if they
will take the turn or not, the agents evaluated in parallel
the importance of the utterance it has or it is saying
and the turn-holding or turn-taking cues displayed to
judge if they will take the turn or keep the turn. Lessman et al. \citep{lessmann_towards_2004}and \citep{thorisson_multiparty_2010}
used both similar notions of ``intention to speak" \citep{lessmann_towards_2004} or
``urgency to speak" to drive the behavior of their agent
\citep{thorisson_multiparty_2010}. Ravenet et al. \citep{ravenet_conversational_2015} created a model where the participants varied
their behavior related to turn-taking based on their interpersonal
attitudes. In order to have a richer and more
natural turn-taking, these models show the importance
of taking into account factors related to personality,
interpersonal attitude, emotion and the content of the
conversation or at least letting the behavior of the agent
vary according to these factors.

\subsection{Turn-taking behavior as a continuous process }

The approaches presented above are first steps towards improving the coordination of speaking turns between users and agents. Accurately detecting the behavior of the user is a first step towards improving the coordination of speaking turns between users and agents. More complex approaches allow the agent to vary its turn-taking behavior related to turn-taking by applying "turn-taking strategies" \citep{ter_maat_how_2010} to display attitudes of dominance or power towards the user \citep{ravenet_conversational_2015,cafaro_effects_2016}, vary urgency to speak \citep{selfridge_bidding_2009}.

 These approaches share common characteristics, once reached a high degree of certainty about the partner's behavior, they make ponctual decisions about the current behavior to trigger (either taking, yielding, interrupting, keeping the turn) and do not often revise their decision or if they do, revise their decision in a significant amount of time that could be inappropriate regarding timing of turn-taking.
 Contrarily, participants in human interactions continuously perceive and react to their partner's behavior \citep{clancy_co-constructed_2015}. Participants continuously adapt their signals to the behavior of their partner and their final behaviors (either the locutor stop or continue to speak, either the listener take the turn or not) cannot be planned in advance. For example, the current speaker trying to keep the turn can display signals showing the current listener that he wants to keep the turn, then deciding to raise its voice, increasing its speech rate, constantly repeating the last syllable. These behaviors are however not fixed in advance but are continuously dependent of what the listener does, if the listener show insistance in trying to take the turn, the current speaker can choose to insist more and more to keep the turn (for example rising more and more its voice to try to prevent the current listener to take the turn) and then, as the overlap last, the current speaker can finally interrupt itself to let the current listener take the turn.  
 A similar observation can be made to the listener engaged in a conflict for taking the turn, he can more and more insist on its turn-taking signals, to try to take the turn.
 Behaviors of the participants are then highly dynamic, continuously evolving through the interaction, and directly dependant of the signal production of their partner. In that sense, turn-taking behaviors can't be entirely determined by the agent, but is a result of an initial goal (taking, yielding, keeping the turn), and a continuous adaptation to the partner's actions. Actual models lack explaining how participants can smoothly coordinate their turn by continuously adapting to their partner's signals.  
 
 Moreover, as observed by \cite{thorisson_natural_2002}, participants coordinating their turns are under temporal constraints, they act whether or not they are completely certain about the intentions of their partners towards turn-taking, that is, whether their partners is trying to change role (from listener to speaker or conversely) or not. That can be the case for example, for a listener waiting the end of the current speaker's turn to take the turn, even if he is not completely certain about the nature of the speaker's silence (whether he is only pausing or if he ended its turn) as the silence last, he will certainly finish by acting towards taking the turn.
 	
 These two characteristics, continuous adaptations to the partner's behavior and action under uncertainty are not new in the field of embodied conversational agents. Recent works have promoted the need for agents able to incrementally perceive the user's behavior and react to it before the end of its behavior. These kind of models have been applied to the management of dialog between user and agent \cite{skantze_towards_2010}, or backchannel eliciting behaviors \cite{buschmeier_when_2014}. For developing agents that are able to incrementally process and react to the user's behavior, \cite{kopp_architecture_2014} have proposed the ASAP architecture, extending the SAIBA architecture by adding ability to continuously perceive the behavior of the user an adapt the ongoing behavior of the agent accordingly. 
 
 Nevertheless, to our knowledge, no model have applied this principle of continuous perception and action to turn-taking, our aim is to create such a model. 

We propose a generative model of turn-taking motivated both by cognitive psychology models and by studies
that have measured alignment or synchrony effects without postulating the nature of the cognitive process
behind these phenomena. This model is based on general cognitive psychology theory that describes the
processes behind the continuous sensori-motor coupling existing between participants in interactions and that
drive the agent's behavior.

% Plusieurs travaux ont étudié le couplage continu existant entre des participants dans une interaction entre des participants humains : 
%	Richardson s'est par exemple intéressé à la coordination du regard entre locuteur et auditeur
%	Keslo s'est intéressé à la coordination de mouvements entre deux participants dans une conversation
%	Rio et al. ont modélisé le comportement de plusieurs agents pietons devant s'éviter
%	Ces approches appartiennent à une approche dite d'approche de dynamique de la cognition. L'objectif est d'expliquer comment la 


Several authors have taken the perspective of a dynamic approach to cognition as conceptualized by Kelso \cite{kelso_coordination_2009} or Warren \citep{warren_dynamics_2006} to model coordination phenomenon, such as coordination of oscillating
members by \citep{haken_theoretical_1985}, locomotion of pedestrians trying to avoid each other \citep{rio_follow_2014} or in human conversations, coordination of postures \citep{fowler_language_2008} .
\citep{rio_follow_2014} used the behavioral dynamics theory as conceptualized by \citep{warren_dynamics_2006} in their computational model of the coordinated motions of pedestrians. The behavioral dynamics framework formulates the control of action by a set of dynamical systems, taking the form of differential equations with control variables that vary in real-time due to the variation of the information provided by the environment.
By precisely defining behavior as a set of
dynamical system, it provides strong principles for the
implementation of computational models derived from the strong theorical principles of these models. 
We then used the behavioral dynamics framework to formulate our model, nevertheless, behavior dynamics do not explain how participants control their actions while being themselves uncertain about their partner's behavior. 

When perceiving their partner's current behavior, the agents are involved in a perceptual task, based on the variations of the signal produced by their partners. Being the current speaker, the agent has to discriminate between two alternatives: is the current listener about to take the take the turn or not? Symmetrically, being the current listener, the agents has to determine whether the speaker is about to yield or to keep the floor. The agent's decision is based on the variation of the signals produced by the other agents during the interaction that the agent can more or less likely perceive.

These conditions of uncertainty and dynamic choice between two alternatives follow the Two Alternative Forced Choice task paradigm (TAFC). This paradigm is extensively used in cognitive psychology to account for
the dynamics of perceptual decision-making of human agents, which have to discriminate the nature of the
stimuli they have in front of them to make a decision \citep{bogacz_physics_2006}. While several models of two alternative forced choice tasks have been created (see \citep{bogacz_physics_2006} for a review), one of the most widely used and simplest models is the drift diffusion model elaborated by Ratcliff \citep{ratcliff_theory_1978}. 
We chose to use the drift diffusion model to explain how our agent will perceive the behavior of its partners based on the multimodal signals displayed by the latter. 
%Remains the question of the agent's degree of certainty influence the production of its signals. Does the participant wait to be be certain its partner's behavior to modify its own production of actions, or does the participant continuously modulate its own signal production according to its uncertainty degree about its partner's beahvior ?
% \citep{lepora_embodied_2015} specifically studied the action dynamics of human participants that were
%asked to select an answer to a question by moving the cursor of their mouse to the button corresponding to the right answer. They showed that a model where the agent's action was continuously modulated by its uncertainty better reproduced human action trajectories.
 We postulate that a principle of perception and action in parallel is put in action for the coordination
of turns in human conversations. We assume that the agents are continuously perceiving the multimodal signals
produced by their partners, and that they modulate in parallel their own actions (verbal and nonverbal
productions), according to the degree of certainty they have towards the nature of the behavior of their partners.
In turn, by modulating their own productions, the agents can early produce signals that are perceived by
their partners and that can push the latter to modulate their own signals, according to their current goal
(taking or yielding the turn). This strong sensorimotor coupling may provoke the beginning of turn, or the end
of turn, earlier than if the agent would simply passively interpreted the signals of its partner without acting in
parallel. What we described here is no more less than a tight coordination that takes place between the agents,
that could partly explain the smooth transitions observed in human interactions. We present our model in
the next section and we will show how principles of continuous adaptation of the agent's behavior towards turn-taking permit to obtain interesting features of turn-taking like automatic adaptation of the agent's behavior to its partner and to the environmental conditions. 